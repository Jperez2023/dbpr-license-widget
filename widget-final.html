<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>DBPR License Check</title>

<style>
/* ==========================================================
   RWorld / BeachesMLS - DBPR License Checker Widget

   VERSION:  Final - Branded & Production-Ready
   AUTHOR:   Data Systems - BeachesMLS / RWorld

   Jotform custom widget that validates RE licenses against
   DBPR before an application can submit. Hits our ActivePieces
   webhook -> NEON DB -> returns status, auto-fills form fields.

   ----------------------------------------------------------
   MAINTENANCE RULES - read before touching anything
   ----------------------------------------------------------
   OK  Colors / fonts     ->  BRAND KIT section (CSS vars)
   OK  Webhook URL        ->  CONFIG object in <script>
   OK  Jotform fields     ->  populateFormFields() only
   NO  Everything else    ->  Don't touch without understanding
                             the full flow. It's all connected.
   ========================================================== */


/* ==========================================================
   BRAND KIT
   ----------------------------------------------------------
   Everything visual lives here. One change -> updates everywhere.
   Colors pulled directly from the official RWorld logo files:
     #1B3A5C  navy  ->  REALTORS wordmark
     #2BBFB3  teal  ->  palm circle + button accent
   ========================================================== */
:root {
  /* -- RWorld Official Brand Colors (from logo assets) ----- */
  --brand-primary:    #1B3A5C;   /* Navy - REALTORS wordmark              */
  --brand-primary-2:  #2BBFB3;   /* Teal - palm circle / button accent    */

  /* Surface & layout */
  --brand-bg:         #F4F7FB;
  --brand-surface:    #FFFFFF;
  --brand-text:       #0F172A;
  --brand-muted:      #64748B;
  --brand-border:     #E2E8F0;

  /* Status colors - Approved */
  --ok-bg:            #ECFDF5;
  --ok-border:        #A7F3D0;
  --ok-text:          #065F46;

  /* Status colors - Blocked */
  --bad-bg:           #FEF2F2;
  --bad-border:       #FECACA;
  --bad-text:         #7F1D1D;

  /* Status colors - Not Found / Warning */
  --warn-bg:          #FFFBEB;
  --warn-border:      #FDE68A;
  --warn-text:        #7C2D12;

  /* Button gradients */
  --btn-grad-a:       #2BBFB3;   /* left */
  --btn-grad-b:       #1B3A5C;   /* right */

  /* Typography */
  --font: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: var(--font);
  background: transparent;
  color: var(--brand-text);
}

/* ==========================================================
   CARD LAYOUT
   ========================================================== */
.card {
  max-width: 560px;
  margin: 16px auto;
  background: var(--brand-surface);
  border: 1px solid var(--brand-border);
  border-radius: 24px;
  box-shadow: 0 18px 40px rgba(2, 6, 23, 0.08);
  overflow: hidden;
}

.header {
  padding: 18px 20px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
}

.logoWrap {
  display: flex;
  align-items: center;
  gap: 10px;
}

.logoImg {
  height: 44px;
  width: auto;
  display: block;
}

.titleWrap {
  text-align: right;
  line-height: 1.1;
}

.titleWrap .small {
  font-weight: 700;
  letter-spacing: 0.14em;
  color: var(--brand-muted);
  font-size: 14px;
}

.titleWrap .big {
  font-weight: 800;
  font-size: 26px;
  color: var(--brand-primary-2);
}

.divider {
  height: 5px;
  background: var(--brand-primary-2);
}

/* ==========================================================
   CONTENT
   ========================================================== */
.content {
  padding: 22px 22px 28px;
}

.lead {
  font-size: 22px;
  color: var(--brand-muted);
  line-height: 1.35;
  margin: 0 0 18px;
}

.inputRow {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.licenseInput {
  width: 100%;
  padding: 18px 22px;
  font-size: 30px;
  border-radius: 18px;
  border: 3px solid rgba(43, 191, 179, 0.5);
  outline: none;
  transition: box-shadow 0.15s ease, border-color 0.15s ease;
}

.licenseInput:focus {
  border-color: var(--brand-primary-2);
  box-shadow: 0 0 0 5px rgba(43, 191, 179, 0.22);
}

.btn {
  width: 100%;
  border: none;
  border-radius: 18px;
  padding: 18px 16px;
  cursor: pointer;
  font-size: 26px;
  font-weight: 800;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  background: linear-gradient(90deg, var(--btn-grad-a), var(--btn-grad-b));
  box-shadow: 0 10px 24px rgba(27, 58, 92, 0.25);
  transition: transform 0.08s ease, filter 0.15s ease;
}

.btn:active { transform: translateY(1px); }
.btn:disabled {
  cursor: not-allowed;
  filter: grayscale(0.25) opacity(0.7);
  box-shadow: none;
}

.hint {
  margin-top: 12px;
  font-size: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--brand-muted);
}

.hint .dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #ef4444;
  display: inline-block;
}

/* ==========================================================
   STATUS BOXES
   ========================================================== */
.statusBox {
  margin-top: 18px;
  padding: 18px 18px 16px;
  border-radius: 18px;
  border: 2px solid transparent;
  background: var(--brand-bg);
  display: none;
}

.statusBox.show { display: block; }

.bad { background: var(--bad-bg); border-color: var(--bad-border); color: var(--bad-text); }
.ok  { background: var(--ok-bg);  border-color: var(--ok-border);  color: var(--ok-text);  }
.warn{ background: var(--warn-bg); border-color: var(--warn-border); color: var(--warn-text); }

.pillRow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
}

.pill {
  display: inline-flex;
  align-items: center;
  padding: 7px 16px;
  border-radius: 999px;
  font-weight: 900;
  letter-spacing: 0.06em;
  border: 2px solid rgba(0,0,0,0.08);
  background: rgba(255,255,255,0.75);
  font-size: 18px;
}

.statusText {
  font-size: 22px;
  line-height: 1.35;
  margin: 0;
}

.statusText strong { font-weight: 900; }

.links {
  margin-top: 10px;
  font-size: 20px;
}

.links a {
  color: inherit;
  text-decoration: underline;
  font-weight: 800;
}

/* ==========================================================
   ACK ROW
   ========================================================== */
.ackWrap {
  margin-top: 14px;
  border: 2px solid rgba(0,0,0,0.08);
  border-radius: 16px;
  padding: 14px 14px;
  background: rgba(255,255,255,0.55);
}

.ackRow {
  display: flex;
  align-items: flex-start;
  gap: 14px;
  cursor: pointer;
}

.check {
  width: 28px;
  height: 28px;
  border-radius: 7px;
  border: 3px solid rgba(0,0,0,0.25);
  background: white;
  flex: 0 0 auto;
  margin-top: 3px;
  position: relative;
}

.checked .check {
  border-color: rgba(0,0,0,0.18);
  background: rgba(255,255,255,0.85);
}

.checked .check::after {
  content: "";
  position: absolute;
  left: 7px;
  top: 3px;
  width: 8px;
  height: 14px;
  border: solid rgba(0,0,0,0.65);
  border-width: 0 4px 4px 0;
  transform: rotate(45deg);
}

.ackText {
  font-size: 22px;
  line-height: 1.35;
  font-weight: 700;
}

/* Mobile fit */
@media (max-width: 520px) {
  .card { margin: 10px; }
  .lead { font-size: 20px; }
  .licenseInput { font-size: 26px; }
  .btn { font-size: 22px; }
  .titleWrap .big { font-size: 22px; }
}
</style>
</head>

<body>
  <div class="card">
    <div class="header">
      <div class="logoWrap">
        <img class="logoImg" src="https://i.imgur.com/RjG5UnW.png" alt="REALTORS" />
      </div>

      <div class="titleWrap">
        <div class="small">MEMBERSHIP PORTAL</div>
        <div class="big">DBPR License Check</div>
      </div>
    </div>

    <div class="divider"></div>

    <div class="content">
      <p class="lead">
        Enter your RE License # to verify your status with DBPR.
        Verification is required before this application can be submitted.
      </p>

      <div class="inputRow">
        <input
          id="licenseInput"
          class="licenseInput"
          type="text"
          inputmode="text"
          autocomplete="off"
          placeholder="e.g. BK123456"
        />

        <button id="checkBtn" class="btn" type="button">
          <span aria-hidden="true">ðŸ”Ž</span>
          <span>Check License</span>
        </button>

        <div id="hint" class="hint">
          <span class="dot"></span>
          <span>Check the box above to acknowledge and continue</span>
        </div>
      </div>

      <!-- STATUS BOX -->
      <div id="statusBox" class="statusBox warn">
        <div class="pillRow">
          <span id="statusPill" class="pill">NOT FOUND</span>
        </div>

        <p id="statusText" class="statusText"></p>

        <div id="links" class="links"></div>

        <!-- ACK BOX -->
        <div id="ackWrap" class="ackWrap" style="display:none;">
          <div id="ackRow" class="ackRow" onclick="toggleAck()">
            <div class="check" aria-hidden="true"></div>
            <div class="ackText" id="ackText"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/* ==========================================================
   CONFIGURATION
   ----------------------------------------------------------
   Only change values here when deploying to different env.
   ========================================================== */
const CONFIG = {
  WEBHOOK_URL: "https://cloud.activepieces.com/api/v1/webhooks/ApTgPgHG8eYS0TxOrZCHq,
  APPROVED: {
    primary_status:   "Current",
    secondary_status: "Active"
  },
  CONTACT_EMAIL: "Membership@rworld.com",
  DBPR_SITE: "myfloridalicense.com"
};


/* ==========================================================
   GLOBAL STATE
   ----------------------------------------------------------
   These variables drive validation and what gets sent to Jotform.
   - lookupComplete:  has the user run a lookup this session?
   - isApproved:      did DBPR return Current + Active?
   - isAcknowledged:  if blocked/not found, did user check ack box?
   - currentRecord:   raw DB record from NEON (null if not found)
   - currentLicenseNo: cleaned license number from last lookup
   ========================================================== */
let lookupComplete   = false;
let isApproved       = false;
let isAcknowledged   = false;
let currentRecord    = null;
let currentLicenseNo = "";
let jfReady         = false;  /* Jotform API becomes safe to call only after the widget fires the "ready" event */


/* ==========================================================
   JOTFORM WIDGET BOOTSTRAP
   ----------------------------------------------------------
   Jotform provides a global object: JFCustomWidget
   We subscribe to:
   - ready  : widget is loaded, can call sendData()
   - submit : user clicked submit, must call sendSubmit()
   ========================================================== */
JFCustomWidget.subscribe("ready", function () {
  /*
    IMPORTANT: Jotform will ignore (or behave inconsistently with) sendData()
    until the widget fires "ready". Many "my widget won't update" issues are
    actually "sendData was called too early".

    We flip this flag so syncToJotform() becomes a no-op until Jotform is ready.
  */
  jfReady = true;

  /* If editing an existing submission, restore prior value */
  const existing = JFCustomWidget.getWidgetSetting("value");
  if (existing) {
    document.getElementById("licenseInput").value = existing;
  }

  /* Start in invalid state - user must verify before submitting */
  syncToJotform();

  /* Ensure the iframe resizes to fit initial content */
  resizeFrame();
});

JFCustomWidget.subscribe("submit", function () {
  /*
    valid = true only if:
    A) Lookup ran AND license is Current+Active, OR
    B) Lookup ran AND user acknowledged the bad/missing status
  */
  const canSubmit = lookupComplete && (isApproved || isAcknowledged);

  JFCustomWidget.sendSubmit({
    valid: canSubmit,
    value: buildSubmissionValue(),
  });
});


/* ==========================================================
   BUILD SUBMISSION PAYLOAD

   This JSON string is what gets stored in the Jotform
   submission for this field. Structure:
   {
     license_number: "...",
     approved: true|false,
     acknowledged: true|false,
     record: {...} | null
   }

   NOTE: This is stored as a string because Jotform widget
   values are plain text. We'll store JSON text for later parsing.
   ========================================================== */
function buildSubmissionValue() {
  return JSON.stringify({
    license_number: currentLicenseNo || "",
    approved: !!isApproved,
    acknowledged: !!isAcknowledged,
    record: currentRecord || null,
  });
}


/* ==========================================================
   syncToJotform()
   ----------------------------------------------------------
   Real-time updates to Jotform field state. This lets Jotform
   treat the widget like a "required" field with validation.

   IMPORTANT:
   - sendData() updates as the user interacts.
   - sendSubmit() is only used on submit event.
   ========================================================== */
function syncToJotform() {
  /*
    Keep Jotform in sync with the widget state.

    NOTE:
    - sendData() updates the field "value" and "valid" state in real-time.
    - sendData() is NOT the same as sendSubmit(); sendSubmit() is only for the
      actual submit event and must be called inside the "submit" subscription.

    CRITICAL:
    Jotform is not guaranteed to accept sendData() until "ready" has fired.
    So we bail out quietly until jfReady = true.
  */
  if (!jfReady) return;

  const valid = lookupComplete && (isApproved || isAcknowledged);

  JFCustomWidget.sendData({
    valid,
    value: buildSubmissionValue(),
  });
}


/* ==========================================================
   escHtml()
   ----------------------------------------------------------
   Run ALL user input and API data through this before touching
   innerHTML. One XSS in a member-facing app is one too many.
   ========================================================== */
function escHtml(str) {
  return String(str || "")
    .replace(/&/g,  "&amp;")
    .replace(/</g,  "&lt;")
    .replace(/>/g,  "&gt;")
    .replace(/"/g,  "&quot;")
    .replace(/'/g,  "&#039;");
}


/* ==========================================================
   MAIN LOOKUP - runLookup()

   Called on button click or Enter key.
   1. Validates input
   2. Resets state
   3. Shows loading UI
   4. POSTs to ActivePieces webhook -> NEON DB
   5. Passes result to handleResult()
   ========================================================== */
async function runLookup() {
  const input     = document.getElementById("licenseInput");
  const licenseNo = input.value.trim().replace(/[^a-zA-Z0-9]/g, "");

  /* Reject empty input - flash red border as feedback */
  if (!licenseNo) {
    input.style.borderColor = "#dc2626";
    input.style.boxShadow   = "0 0 0 3px rgba(220,38,38,0.15)";
    setTimeout(() => {
      input.style.borderColor = "";
      input.style.boxShadow   = "";
    }, 650);
    return;
  }

  /* Reset state before new lookup */
  lookupComplete   = false;
  isApproved       = false;
  isAcknowledged   = false;
  currentRecord    = null;
  currentLicenseNo = licenseNo;

  /* UI: show loading state */
  setLoading(true);
  hideStatus();

  try {
    const res = await fetch(CONFIG.WEBHOOK_URL, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ license_number: licenseNo })
    });

    /* Parse response as JSON */
    const data = await res.json();

    /* Hand off to result handler */
    handleResult(data, licenseNo);
  } catch (err) {
    showError(licenseNo, err);
    syncToJotform();
    resizeFrame();
  } finally {
    setLoading(false);
  }
}


/* ==========================================================
   handleResult(data, licenseNo)

   Converts API response -> UI and state flags.

   FIX INCLUDED:
   ActivePieces can wrap output in:
   - data.body
   - data.fields.body
   - raw payload
   This normalizer ensures the widget updates regardless.
   ========================================================== */
function handleResult(data, licenseNo) {
  /*
    ActivePieces can return your JSON in a few different wrappers depending on:
    - whether you're looking at the webhook trigger output
    - whether you're looking at the "Return Response" output
    - whether something upstream re-wrapped the payload

    Shapes we support here:

    1) Return Response output (common):
       { status: 200, headers: {...}, body: { found: false, records: [] } }

    2) Webhook trigger / step output (also common in debugging):
       { fields: { body: { found: false, records: [] }, status: 200, headers: {...} } }

    3) Raw payload (less common):
       { found: false, records: [] }

    This normalizer makes the UI update reliably regardless of wrapper.
  */
  lookupComplete = true;

  /* ---------------------------------------------------------
     Normalize the response into the "payload" object we expect
     --------------------------------------------------------- */
  let payload = (data && data.body) ? data.body
              : (data && data.fields && data.fields.body) ? data.fields.body
              : data;

  /* If body came back as a JSON string for any reason, parse it */
  if (typeof payload === "string") {
    try {
      payload = JSON.parse(payload);
    } catch (e) {
      /* Leave payload as-is if it is not valid JSON */
    }
  }

  /* Guard: if payload is missing or malformed, treat as "not found" */
  if (!payload || !payload.found || !payload.records || payload.records.length === 0) {
    showNotFound(licenseNo);

    /* Keep Jotform's valid/value state in sync */
    syncToJotform();

    /* Ensure the iframe resizes to fit the not-found card */
    resizeFrame();
    return;
  }

  /* Found at least one record */
  const record  = payload.records[0];
  currentRecord = record;

  /* Both must match CONFIG.APPROVED values for full approval */
  const primaryOk   = (record.primary_status   || "").trim() === CONFIG.APPROVED.primary_status;
  const secondaryOk = (record.secondary_status || "").trim() === CONFIG.APPROVED.secondary_status;
  isApproved        = primaryOk && secondaryOk;

  if (isApproved) {
    showApproved(record, licenseNo);
    populateFormFields(record);   /* Auto-fill name, address, office */
  } else {
    showBlocked(record, licenseNo);
  }

  /* Sync Jotform field state after UI changes */
  syncToJotform();

  /* Resize iframe after UI changes */
  resizeFrame();
}


/* ==========================================================
   ACKNOWLEDGE TOGGLE - toggleAck()

   Attached to the acknowledgment row click.
   Flips isAcknowledged and updates Jotform valid state.
   ========================================================== */
function toggleAck() {
  isAcknowledged = !isAcknowledged;

  const row = document.getElementById("ackRow");
  row.classList.toggle("checked", isAcknowledged);

  updateHint(
    isAcknowledged ? "warn" : "bad",
    isAcknowledged
      ? "Acknowledged - application will be reviewed by membership staff"
      : "Check the box above to acknowledge and continue"
  );

  syncToJotform();
  resizeFrame();
}


/* ==========================================================
   UI HELPERS
   ========================================================== */
function setLoading(isLoading) {
  const btn = document.getElementById("checkBtn");
  btn.disabled = isLoading;
  btn.style.filter = isLoading ? "grayscale(0.25) opacity(0.7)" : "";
}

function hideStatus() {
  const box = document.getElementById("statusBox");
  box.classList.remove("show", "bad", "ok", "warn");
  box.style.display = "none";

  const ackWrap = document.getElementById("ackWrap");
  ackWrap.style.display = "none";

  /* Reset hint */
  updateHint("bad", "Check the box above to acknowledge and continue");
}

function showStatus(type, pillText, htmlText, linksHtml, showAck) {
  const box  = document.getElementById("statusBox");
  const pill = document.getElementById("statusPill");
  const text = document.getElementById("statusText");
  const links= document.getElementById("links");
  const ackWrap = document.getElementById("ackWrap");

  box.classList.remove("bad", "ok", "warn");
  box.classList.add(type);
  box.style.display = "block";
  box.classList.add("show");

  pill.textContent = pillText;
  text.innerHTML   = htmlText;
  links.innerHTML  = linksHtml || "";

  ackWrap.style.display = showAck ? "block" : "none";

  if (showAck) {
    /* Set checkbox text each time so it always matches license number */
    const ackText = document.getElementById("ackText");
    ackText.innerHTML = `I understand license <strong>#${escHtml(currentLicenseNo)}</strong> could not be verified. I acknowledge my application will require manual review by membership staff before approval.`;

    /* Reset checkbox state visually when we show it */
    isAcknowledged = false;
    document.getElementById("ackRow").classList.remove("checked");
  }
}

function showNotFound(licenseNo) {
  showStatus(
    "warn",
    "NOT FOUND",
    `License <strong>#${escHtml(licenseNo)}</strong> was not found in our DBPR records.<br/>
     Double-check your number (no dashes or special characters) and try again.`,
    `Questions? <a href="mailto:${escHtml(CONFIG.CONTACT_EMAIL)}">${escHtml(CONFIG.CONTACT_EMAIL)}</a> or
     <a href="https://${escHtml(CONFIG.DBPR_SITE)}" target="_blank" rel="noopener">${escHtml(CONFIG.DBPR_SITE)}</a>`,
    true
  );
}

function showBlocked(record, licenseNo) {
  const primary   = escHtml(record.primary_status || "Unknown");
  const secondary = escHtml(record.secondary_status || "Unknown");

  showStatus(
    "bad",
    "NOT APPROVED",
    `License <strong>#${escHtml(licenseNo)}</strong> was found, but does not meet the required status.<br/>
     Current status: <strong>${primary}</strong> and <strong>${secondary}</strong>.`,
    `Questions? <a href="mailto:${escHtml(CONFIG.CONTACT_EMAIL)}">${escHtml(CONFIG.CONTACT_EMAIL)}</a> or
     <a href="https://${escHtml(CONFIG.DBPR_SITE)}" target="_blank" rel="noopener">${escHtml(CONFIG.DBPR_SITE)}</a>`,
    true
  );
}

function showApproved(record, licenseNo) {
  const name = escHtml(record.name || "");
  showStatus(
    "ok",
    "APPROVED",
    `License <strong>#${escHtml(licenseNo)}</strong> is verified and approved.<br/>
     ${name ? `Welcome, <strong>${name}</strong>.` : ""}`,
    "",
    false
  );

  updateHint("ok", "Verified - you may continue");
}

function showError(licenseNo, err) {
  showStatus(
    "bad",
    "ERROR",
    `We could not verify license <strong>#${escHtml(licenseNo)}</strong> due to a system error.<br/>
     Please try again. If it continues, contact <strong>${escHtml(CONFIG.CONTACT_EMAIL)}</strong>.`,
    "",
    true
  );
}


/* ==========================================================
   updateHint(type, message)
   ----------------------------------------------------------
   Updates the line under the button with dot color + message.
   ========================================================== */
function updateHint(type, message) {
  const hint = document.getElementById("hint");
  const dot  = hint.querySelector(".dot");
  const text = hint.querySelector("span:last-child");

  text.textContent = message || "";

  if (type === "ok") {
    dot.style.background = "#10b981";
  } else if (type === "warn") {
    dot.style.background = "#f59e0b";
  } else {
    dot.style.background = "#ef4444";
  }
}


/* ==========================================================
   populateFormFields(record)
   ----------------------------------------------------------
   Pushes selected DBPR values into Jotform fields.
   You MUST match Jotform field names/IDs exactly.
   ========================================================== */
function populateFormFields(record) {
  /*
    NOTE:
    Jotform widgets can set other fields using setFieldsValue.
    This is only safe after "ready" has fired, but by the time
    we call this, the user has clicked and the widget is ready.

    Replace the keys below with your actual Jotform field IDs.
  */

  const payload = {};

  /* Example mapping (replace with real field IDs) */
  if (record.name)        payload["agent_name"]  = record.name;
  if (record.address)     payload["agent_addr"]  = record.address;
  if (record.city)        payload["agent_city"]  = record.city;
  if (record.state)       payload["agent_state"] = record.state;
  if (record.zip)         payload["agent_zip"]   = record.zip;
  if (record.office_name) payload["office_name"] = record.office_name;

  /* Only send if we actually have something to set */
  const keys = Object.keys(payload);
  if (keys.length === 0) return;

  try {
    JFCustomWidget.setFieldsValue(payload);
  } catch (e) {
    /* Fail silently - we do not want to block the user if field IDs are wrong */
  }
}


/* ==========================================================
   resizeFrame()
   ----------------------------------------------------------
   Jotform embeds widgets in an iframe. If the iframe height
   is not updated, status cards can get clipped.
   ========================================================== */
function resizeFrame() {
  try {
    JFCustomWidget.requestFrameResize();
  } catch (e) {
    /* Some environments may not support resizing - ignore */
  }
}


/* ==========================================================
   EVENT WIRING
   ========================================================== */
document.getElementById("checkBtn").addEventListener("click", runLookup);

document.getElementById("licenseInput").addEventListener("keydown", function (e) {
  if (e.key === "Enter") {
    e.preventDefault();
    runLookup();
  }
});
</script>
</body>
</html>
